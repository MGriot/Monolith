# [BACK-007] Logic: Dependencies & Cycle Detection

**Date:** 2026-01-28
**Author:** Ralph (AI Agent)
**Status:** Verified

## Changes
- Updated `backend/app/schemas/task.py` to include `blocked_by_ids` in Task schemas.
- Modified `backend/app/crud/crud_task.py`:
    - Implemented recursive cycle detection (`is_blocked_by_recursive`) using DFS.
    - Implemented Finish-to-Start validation: preventing completion of tasks with active (non-DONE) blockers.
    - Overrode `create` and `update` in `CRUDTask` to manage the `blocking_tasks` relationship.
    - Ensured dependencies are loaded using `selectinload` for efficient status checking.

## Verification
- Created `backend/test_dependencies_standalone.py`.
- Validated:
    - Direct and indirect circular dependencies are detected and prevented.
    - Self-blocking is prevented.
    - Task completion is blocked if dependencies are not `DONE`.
    - Task completion is allowed once dependencies are `DONE`.